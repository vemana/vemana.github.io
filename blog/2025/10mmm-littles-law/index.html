<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>10 Minute Mental Model: Little's law, the giant governing Throughput &amp; Latency | Vemana's Space.</title> <meta name="author" content="Subrahmanyam "> <meta name="description" content="Where there's a queue, there's Little's law."> <meta name="keywords" content="software-engineering, math"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://vemana.github.io/blog/2025/10mmm-littles-law/"> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Vemana's Space.</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <style type="text/css">span.danger{color:red;font-weight:bold}span.good{color:green;font-weight:bold}span.mid{text-align:center}.monospace td{font-family:monospace,monospace}div.bootstrap-table.bootstrap4{margin-bottom:20px}</style> <div class="post"> <header class="post-header"> <h1 class="post-title">10 Minute Mental Model: Little's law, the giant governing Throughput &amp; Latency</h1> <p class="post-meta">February 26, 2025</p> <p class="post-tags"> <a href="/blog/2025"> <i class="fas fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/software-performance"> <i class="fas fa-hashtag fa-sm"></i> software-performance</a>     ·   <a href="/blog/category/software-engineering"> <i class="fas fa-tag fa-sm"></i> software-engineering</a>   <a href="/blog/category/10-minute-mental-models"> <i class="fas fa-tag fa-sm"></i> 10-minute-mental-models</a>   </p> </header> <article class="post-content"> <div id="table-of-contents"> <ul id="toc" class="section-nav"> <li class="toc-entry toc-h3"><a href="#canonical-example">Canonical Example</a></li> <li class="toc-entry toc-h3"><a href="#understanding-throughput--latency-a-museum-example">Understanding Throughput &amp; Latency: A museum example</a></li> <li class="toc-entry toc-h3"><a href="#littles-law">Little’s Law</a></li> <li class="toc-entry toc-h3"><a href="#using-littles-law-in-practice">Using Little’s Law in practice</a></li> <li class="toc-entry toc-h3"><a href="#wrapping-up">Wrapping up</a></li> </ul> </div> <hr> <div id="markdown-content"> <blockquote class="block-tip"> <p><a href="/blog/2023/10mmm">Learn more</a> about the 10 Minute Mental Model series</p> </blockquote> <h3 id="canonical-example">Canonical Example</h3> <p>I am going to write a GPU program using CUDA. I think it will be fast but I am not sure if it can be significantly faster. Am I getting the most out of the hardware? Do I need to write the program, then measure and improve performance or can I architect it in sympathy with the hardware and get most of the performance the first go around before any profiling?</p> <p>If you are familiar with this feeling, be it for GPU, Storage or NIC hardware, this post may help a little (no pun intended) bit!</p> <h3 id="understanding-throughput--latency-a-museum-example">Understanding Throughput &amp; Latency: A museum example</h3> <p>Imagine a museum where people queue to get in and once they are in, take different routes and spend different amounts of time in the museum before exiting it. <strong>What are some metrics to monitor the logistical functioning of the museum</strong>? The common ones are:</p> <ul> <li>Latency: How long does a person stay in the system (either in the queue or in the museum)</li> <li>Throughput: How many people exit the museum per minute</li> <li> <strong>Reciprocal Throughput</strong>: What’s the average spacing (in minutes) between two consecutve people exiting the museum. This is just <code class="language-plaintext highlighter-rouge">1/Throughput</code> and can be more intuitive in some cases</li> </ul> <p><strong>What’s the relevance of the museum example?</strong> In typical software, museum-like systems are everywhere. For example, to read a disk, the request is first queued by the OS and then dispatched (potentially after coalescing with other requests) to disk. The disk then has its own queuing system. It’s not just disk, but pretty much all limited resources follow the same pattern; CPU threads are queued waiting for a chance to run, network packets are queued on both send and receieve and so on. If you want to improve performance of any of these subsytems, you’ll need reliable metrics. Those metrics will be similar to what one might monitor for a museum.</p> <p><strong>Why museum?</strong> Because latency and reciprocal throughput are orders of magnitude apart. In a typical museum, Latency is order of hours while <code class="language-plaintext highlighter-rouge">Reciprocal Throughput</code> is on the order of secs. When reasoning about programs, it is easy to conflate the two metrics because they are purely abstract concepts whereas a physical example like a museum makes it difficult to conflate.</p> <p><strong>Why these two metrics vs others?</strong> Because they tie into economics.</p> <ul> <li>A high throughput museum amortizes their fixed costs over larger number of people</li> <li>A low latency museum makes for a better visitor experience</li> </ul> <p>Analogously, in software too, they tie into economics.</p> <ul> <li>High throughput = we get more work done for the same hardware</li> <li>Low latency = fast response for an end user</li> </ul> <h3 id="littles-law">Little’s Law</h3> <p>All else equal, we want higher throughput and lower latency; so can we keep improving them simultaneously <em>ad nauseam</em>? And if not, why not?</p> <p>It turns out that Little’s law places some limits.</p> <blockquote class="block-tip"> <p><strong>Little’s Law</strong> (<a href="https://en.wikipedia.org/wiki/Little%27s_law" rel="external nofollow noopener" target="_blank">wiki</a>)</p> <p>Average Throughput x Average Latency = Average number of things in the system</p> </blockquote> <table> <thead> <tr> <th>System</th> <th>Throughput metric</th> <th>Latency metric</th> <th>Number of things in the system metric</th> <th>Comment</th> </tr> </thead> <tbody> <tr> <td>SSD</td> <td>IOPS = IO operations per second</td> <td>Operation latency</td> <td>Queue Depth = Outstanding IOPs inside the SSD.</td> <td>On a single core, async IO can maintain a large queue depth so the SSD is always working on as many requests as possible while sync io can only maintain QD=1.</td> </tr> <tr> <td>CPU (assume Thread per Task)</td> <td>Tasks per second</td> <td>Task latency</td> <td>Number of tasks = number of threads</td> <td>When your tasks block a lot (for example, file server blocking on file reads) and the tasks are synchronous (no async/reactive programming), CPU utilization will be very low. You need a lot of threads in the system to utilize all the available CPU cycles. Java’s Virtual Threads allows millions of virtual threads (tasks) to coexist at the same time and switches them cheaply when blocked. This keeps CPU cycles utilized <strong>without resorting to async or reactive programming</strong>.</td> </tr> <tr> <td>GPU</td> <td>Warps per second</td> <td>Warp latency</td> <td>Number of Warps</td> <td>Warp = ~32 threads in Single Instruction Multiple Threads mode. You need a lot of blocks (warps are subsets of blocks) to keep the GPUs fed while some warps need to be switched out waiting on memory. Unlike thread switching, warp switching is very fast (a few cycles), so they get switched even when waiting on memory.</td> </tr> <tr> <td>Memory Buffers when writing to disk</td> <td>Disk’s write bandwidth: blocks (say block = 4K bytes) per second</td> <td>Latency of a single block write</td> <td>Number of bytes (blocks * blockSize) in memory holding data that the disk is currently writing (the so called buffers)</td> <td> </td> </tr> </tbody> </table> <p>The charts below demonstrate Little’s law in action. These are real numbers from an SSD that is rated for 1M 4K random read IOPS, tested at various queue depths. That is, the testing mechanism (fio) ensures that <code class="language-plaintext highlighter-rouge">QD</code> requests are outstanding at any moment. Notice how the IOPS linearly increases with QD while latency remains roughly flat until depth 64. Beyond that, latency starts climbing noticeably while the disk reaches its saturation point of 1M IOPS. I didn’t capture the test results for QD 256 in this graph, but compared to QD 128, latency doubles while IOPS remains the same. This is because QD 128 already saturated the IOPS available on the SSD.</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/littleslaw-ssd-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/littleslaw-ssd-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/littleslaw-ssd-1400.webp"></source> <img src="/assets/img/littleslaw-ssd.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/littleslaw-raw-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/littleslaw-raw-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/littleslaw-raw-1400.webp"></source> <img src="/assets/img/littleslaw-raw.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <h3 id="using-littles-law-in-practice">Using Little’s Law in practice</h3> <p><strong>Little’s law helps saturate hardware.</strong> Example: If an SSD is capable of 1M IOPS (many today are) at 100 us IOP latency, we know that queue depth should be roughly 100 to saturate the SSD. Going beyond this number will just blow up the latency because requests are just going to be sitting in queue instead of being serviced in parallel by the SSD.</p> <p><strong>Little’s law informs software design.</strong> Example: If we know how much data our batch job has to get through and have a rough requirement of latency, we can estimate the average memory usage. Depending upon whether this number is acceptable or too high, we can play with other design parameters.</p> <h3 id="wrapping-up">Wrapping up</h3> <p>Anywhere there’s a queue, there’s Little’s law lurking. And queues are everywhere in software. Now, different applications will want different tradeoffs. A financial exchange order book management system might care about latency the most (and scaleout to handle volume) while most background pipelines of web companies (say Google’s indexing pipelines) will typically prioritize throughput for economic reasons - you want to get more done with the hardware you have. Any which way, Little’s law helps estimate requirements and refine the design as you juggle design parameters.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/webscale-swe-skillset/">The Web-scale Software Engineer Skillset</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/junit-parallel-test-runner/">How to run JUnit tests in parallel with Virtual Threads.</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/10mmm-memory-model/">10 Minute Mental Model: Hardware Memory Models</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/abiyz-intro/">How to think about programs &amp; programming? ABIYZ: inspired by age old tools like arithmetic.</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/testing-calculator-homomorphism/">Can software testing be objective? Hello from Homomorphisms.</a> </li> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Subrahmanyam . </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script src="https://unpkg.com/mermaid@10.6.1/dist/mermaid.min.js" integrity="sha256-mm3Re3y7xlvh+yCD+l/Zs1d+PU0AEad93MkWvljfm/s=" crossorigin="anonymous"></script> <script>$(document).ready(function(){mermaid.initialize({startOnLoad:!0,theme:"default"}),window.mermaid.init(undefined,document.querySelectorAll(".language-mermaid"))});</script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>