<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Are there changes that accelerate software aging? Yes, here's a small list. | Vemana's Space.</title> <meta name="author" content="Subrahmanyam "> <meta name="description" content="Without effective mitigation, some patterns of change accelerate software aging."> <meta name="keywords" content="software-engineering, math"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://vemana.github.io/blog/2023/software-changes-and-aging/"> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Vemana's Space.</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Are there changes that accelerate software aging? Yes, here's a small list.</h1> <p class="post-meta">November 13, 2023</p> <p class="post-tags"> <a href="/blog/2023"> <i class="fas fa-calendar fa-sm"></i> 2023 </a>   ·   <a href="/blog/tag/software-ageability"> <i class="fas fa-hashtag fa-sm"></i> software-ageability</a>     ·   <a href="/blog/category/software-engineering"> <i class="fas fa-tag fa-sm"></i> software-engineering</a>   </p> </header> <article class="post-content"> <div id="table-of-contents"> <ul id="toc" class="section-nav"> <li class="toc-entry toc-h1"><a href="#introduction">Introduction</a></li> <li class="toc-entry toc-h1"> <a href="#some-patterns-of-change-that-accelerate-aging">Some patterns of change that accelerate aging</a> <ul> <li class="toc-entry toc-h2"> <a href="#1-going-from-product-type-to-sum-type">1. Going from Product Type to Sum Type</a> <ul> <li class="toc-entry toc-h3"><a href="#ptos-example1">Example 1</a></li> <li class="toc-entry toc-h3"><a href="#ptos-example2">Example 2</a></li> <li class="toc-entry toc-h3"><a href="#ptos-difficulty">Why this Change is difficult to manage</a></li> <li class="toc-entry toc-h3"><a href="#ptos-practice">In Practice</a></li> </ul> </li> <li class="toc-entry toc-h2"> <a href="#2-exceeding-a-dimensions-implicit-cardinality">2. Exceeding a dimension’s implicit cardinality</a> <ul> <li class="toc-entry toc-h3"><a href="#cardinality-example1">Example</a></li> <li class="toc-entry toc-h3"><a href="#cardinality-difficulty">Why this Change is difficult to manage</a></li> <li class="toc-entry toc-h3"><a href="#cardinality-practice">In Practice</a></li> </ul> </li> <li class="toc-entry toc-h2"> <a href="#3-evolutionary-conflations">3. Evolutionary Conflations</a> <ul> <li class="toc-entry toc-h3"><a href="#conflating-example1">Example</a></li> <li class="toc-entry toc-h3"><a href="#conflation-difficulty">Why this change is difficult to manage</a></li> <li class="toc-entry toc-h3"><a href="#conflation-inpractice">In Practice</a></li> </ul> </li> </ul> </li> <li class="toc-entry toc-h1"><a href="#some-themes">Some themes</a></li> </ul> </div> <hr> <div id="markdown-content"> <h1 id="introduction">Introduction</h1> <p>If you’ve ever observed the software powering a fast growing product, you know that software ages and becomes fragile as requirements change. Can we overcome this aging or at least better manage it?</p> <h1 id="some-patterns-of-change-that-accelerate-aging">Some patterns of change that accelerate aging</h1> <p>In this section, I’ll note some patterns of change that contribute to software aging when not managed properly. These patterns occur during the normal lifecycle of software evolution, typically from changing/newer requirements. My hope is that aging can be managed effectively by virtue of these patterns being recognized &amp; formalized.</p> <h2 id="1-going-from-product-type-to-sum-type">1. Going from Product Type to Sum Type</h2> <blockquote class="block-tip"> <p>When SWEs start off a model (quite reasonably) as a Product Type, changing it to a Sum Type can be a significant effort that is often hacked around.</p> </blockquote> <h3 id="ptos-example1">Example 1</h3> <p>When getting a project off the ground, a SWE might reasonably model a Printer’s output paper like so:<br> <code class="language-plaintext highlighter-rouge">PrinterPaper := (Height, Width)</code></p> <p>Later, requirements change (printer can now print on circular paper) <br> <code class="language-plaintext highlighter-rouge">PrinterPaper := CircularPaper | RectangularPaper</code> <br> <code class="language-plaintext highlighter-rouge">CircularPaper := (Radius)</code> <br> <code class="language-plaintext highlighter-rouge">RectangularPaper := (Height, Width)</code></p> <p>The former version of <code class="language-plaintext highlighter-rouge">PrinterPaper</code> is a Product Type and the latter version is a Sum Type.</p> <h3 id="ptos-example2">Example 2</h3> <p>Suppose you are the software owner and your product is managing 401K plans (like Vanguard). It offers say 3 different <code class="language-plaintext highlighter-rouge">Fund</code>s that an Account holder can put money into. Each <code class="language-plaintext highlighter-rouge">Fund</code> has a price and each Account owns some quantity of each of the 3 funds. That is, <code class="language-plaintext highlighter-rouge">Account := List of (Fund, Quantity)</code> and <code class="language-plaintext highlighter-rouge">Fund := (Price, &lt;other metadata&gt;)</code>.</p> <p>Now, you need to support a SDB (Self Directed Brokerage) for a 4th <code class="language-plaintext highlighter-rouge">Fund</code>; that is, an option for an Account holder to put money into self-managed external brokerage account. It’s no longer true that each <code class="language-plaintext highlighter-rouge">Fund</code> has a notion of <code class="language-plaintext highlighter-rouge">Today's price</code> because SDB doesn’t have a price! You now have a different model: <code class="language-plaintext highlighter-rouge">Fund := FundWithPrice | SDB</code>. That is, <code class="language-plaintext highlighter-rouge">Fund</code> has evolved into a Sum Type from a Product Type.</p> <h3 id="ptos-difficulty">Why this Change is difficult to manage</h3> <p>Going from Product Type to Sum Type often requires a ton of effort. Using example#2, here are some things that need to change in response:</p> <ul> <li>Database: Suppose you are using a relational db and have a table for the supported <code class="language-plaintext highlighter-rouge">Fund</code>s. Data specific to the SDB cannot fit in this table because the properties of a <code class="language-plaintext highlighter-rouge">FundWithPrice</code> are different from <code class="language-plaintext highlighter-rouge">SDB</code>; you need to invest time in a solution.</li> <li>Application: Your API method <code class="language-plaintext highlighter-rouge">retrieveAccountHoldings</code> that returns a <code class="language-plaintext highlighter-rouge">list of (fund_id, quantity, today's price)</code> now has to change to support returning SDB data and the impl has to change to support it. If you have an external API, exposing and versioning this change can be challenging (without good tooling)</li> <li>UI: Your UI was previously displaying Account Holdings in a table with three columns: (Fund, Quantity, Price). You now have to rethink that design in the presence of an SDB.</li> </ul> <h3 id="ptos-practice">In Practice</h3> <p>When confronted with this problem, time/resource constraints often prefer a <strong>hacky solution</strong>: Model an SDB as a <code class="language-plaintext highlighter-rouge">Fund</code> with price = 1 and quantity = amount of money allocated to the SDB! This choice amplifies aging:</p> <ul> <li>If new columns are added to the <code class="language-plaintext highlighter-rouge">Funds</code> database table for SDB specific data (yes, this is a hack), over time, it leads to a messy schema and a new SWE cannot look at the db and understand the data model</li> <li>Somewhere in the application layer, you probably have a class called <code class="language-plaintext highlighter-rouge">Fund</code> with a property called <code class="language-plaintext highlighter-rouge">CurrentPrice</code>. If SDBs are also modeled as instances of <code class="language-plaintext highlighter-rouge">Fund</code>, code gets very messy very quickly because you don’t know whether <code class="language-plaintext highlighter-rouge">CurrentPrice</code> property can be invoked on a given <code class="language-plaintext highlighter-rouge">Fund</code> object.</li> <li>The UI has similar issues; it needs several if/else statements in the code to show the UI differently for SDBs as compared to other regular <code class="language-plaintext highlighter-rouge">Fund</code>s. Many if/else statements are a standard recipe for bugs.</li> </ul> <p>There are no great solutions for this problem today. But, one can imagine end-to-end software development environments (i.e. Programming languages, databases &amp; all parts of the stack) having tooling to make moving from Product Types to Sum Types easy. One thing’s for sure: with even a small number of such hacks, the codebase is a hot mess.</p> <h2 id="2-exceeding-a-dimensions-implicit-cardinality">2. Exceeding a dimension’s implicit cardinality</h2> <blockquote class="block-tip"> <p>When SWEs model data that 1. Contains sets/lists 2. Is customer-specified, there’s often an implicit expectation of the cardinality on those sets/lists. Software ages when these implicit expectations change because customers outgrow the requirements.</p> </blockquote> <h3 id="cardinality-example1">Example</h3> <p>Suppose you are designing a schema where <code class="language-plaintext highlighter-rouge">entity X has a List of entities of type Y</code>. Suppose, you design it assuming that <code class="language-plaintext highlighter-rouge">X has around 1000 of Y</code>. This assumption around 1000 is known widely because <code class="language-plaintext highlighter-rouge">why does anyone ever want more than 1000 Y per X?</code>. At some point, the product grows and some customer needs X to have 10,000 of Y and so they start creating data using this extra cardinality.</p> <h3 id="cardinality-difficulty">Why this Change is difficult to manage</h3> <p>There are many problems with cardinality abuse because SWEs will have expressed this implicit knowledge in their choice of the architecture and algorithms.</p> <ul> <li>Suppose you sharded out compute per <code class="language-plaintext highlighter-rouge">X</code>; i.e. each <code class="language-plaintext highlighter-rouge">X</code> is served by one shard. Once there’s cardinality abuse of <code class="language-plaintext highlighter-rouge">Y per X</code>, the shard processing <code class="language-plaintext highlighter-rouge">big X</code> (i.e X with 10K Y) slows down and that cascades to other <code class="language-plaintext highlighter-rouge">X</code> being served by the shard. You profile those other slow <code class="language-plaintext highlighter-rouge">X</code>s and find nothing wrong. And you didn’t have a way to know that the <code class="language-plaintext highlighter-rouge">big X</code> is monopolizing compute and penalizing all the <code class="language-plaintext highlighter-rouge">small X</code> assigned to its shard!</li> <li>With 1000 entries, an O(N^2) algorithm works fine latency wise, but at 10,000 entries it may produce noticeable delays. SWEs would have chosen O(N^2) algorithm because of the conscious assumption that <code class="language-plaintext highlighter-rouge">N &lt;= 1000</code>. Suddenly, there’s a serious problem: what was once a snappy app is no longer snappy. Worse yet, you don’t even know that this is the reason until you profile and even if you do and identify it, fixing it may be an expensive project of its own.</li> </ul> <p>In other words, when assumptions underlying the architecture are invalidated, production tends to break in mysterious ways. The violations are often slow and steady causing a gradual, insidiuous deterioration over a period of time. By the time a final violation tips it visibly over the edge, there’s not one single thing to blame and often it is just easier to pile on and get more value out of the existing (outdated) architecture rather than redoing it.</p> <h3 id="cardinality-practice">In Practice</h3> <p>The root cause is that some assumptions (like cardinality) are only ever present in human brains (whoever designed them). The architecture initially reflects these (very good) assumptions but after a few requirement changes that invalidate the assumptions, the architecture is no longer suited to the assumptions. Since they were never recorded explicitly in the codebase in the first place, there’s no way to even really know the failure points until a customer abuses a dimension.</p> <p>It is difficult to imagine self-righting architectures in response to observed cardinalities (outside of some special problem domains like auto-sharding databases) until perhaps AI starts writing all the code and change architectures (and data migrations) on the fly. Until then, in practice, explicitly enforcing the implicit assumptions is a reasonable approach. For example, when writing data to the databases, validate that <code class="language-plaintext highlighter-rouge">N &lt;= 1000</code>. This way, if a customer wants to bump up N to 10,000, it’ll fail and you can talk to the customer to learn their use case.</p> <h2 id="3-evolutionary-conflations">3. Evolutionary Conflations</h2> <p class="block-tip">As we all know, distinct concepts require distinct names and distinct treatment; sometimes, the conflation can creep in very subtly through evolution.</p> <h3 id="conflating-example1">Example</h3> <p>You have a store where users either 1. order new gifts or 2. reorder previously ordered gifts. You just launched the store &amp; for each order you randomly picked the packaging color (the user didn’t get a choice). Suppose Order #10 had Red color packaging. Time progresses and you introduce a settings page where the user can configure a default packaging color.</p> <p><strong>Here’s the question</strong>: Suppose the user configures Green for default packaging color and proceeds to reorder Order #10. What color packaging will you use - Green or Red? Both answers are feasible</p> <ul> <li>Red is correct because the user is just reordering a prior Order &amp; expects the same color packaging</li> <li>Green is correct because the user configured Green as the default color &amp; did not explicitly specify it in Order #10 (which is being reordered); so, they expect to get the default</li> </ul> <h3 id="conflation-difficulty">Why this change is difficult to manage</h3> <p>The question of Red vs Green for re-orders arises at the time you introduce the default packaging color option. Your database entry of Order #10 probably looks like <code class="language-plaintext highlighter-rouge">Order {id: 10, packaging_color: Red}</code>. The attribute name <code class="language-plaintext highlighter-rouge">packaging_color</code> is now conflated: does it represent the shipped packaging color or user specified packaging color? It needs to be de-conflated. All because you introduced a new adjacent notion of <em>user specified</em> packaging color.</p> <p>To deconflate, you’ll need to update Order entries in the database to reflect the reality of Order#10: <code class="language-plaintext highlighter-rouge">Order {id: 10, shipped_packaging_color: Red, user_specified_packaging_color: UNSPECIFIED}</code>. Depending upon what the Product team decide, you can now support choosing either RED or GREEN for reordering Order#10.</p> <p>To summarize, instead of a single concept called <code class="language-plaintext highlighter-rouge">packaging_color</code>, you now have two similar concepts &amp; the old concept has to be mapped into one of these new concepts. Further, this distinction has to be reflected in every piece of the stack, not just the database, but also the application layer &amp; the UI and also manage compatibility between different layers while doing these changes. This can be a substantial amount of work. For example, apart from renaming &amp; backfilling, you need to look at all uses of <code class="language-plaintext highlighter-rouge">packaging_color</code> and check that they are all used as if it were <code class="language-plaintext highlighter-rouge">shipped_package_color</code>. This is a pretty difficult undertaking for any large project with tentacles.</p> <h3 id="conflation-inpractice">In Practice</h3> <p>In practice, often a hacky solution is adopted: <code class="language-plaintext highlighter-rouge">For reorders, just use the packaging_color attribute of the order being reordered</code> and <code class="language-plaintext highlighter-rouge">For fresh orders, use the packaging_color attribute for recording the user specified color</code>. It is easy because it requires no further database changes. Unless the product team has a strong opinion on the topic, RED will likely be the chosen answer, just because it is easy.</p> <p>The deconflation may seem unnecessary especially for those already familiar with the product/db schema, but, leaving it out leads to aging:</p> <ul> <li>It ramps up the learning curve for any SWEs onboarding onto the codebase <ul> <li>For example, a new SWE looking at the database does not know what the <code class="language-plaintext highlighter-rouge">packaging_color</code> is supposed to be: user specified or shipped</li> </ul> </li> <li>It is restrictive. Deconflation provides more flexibility. Without deconflation, <ul> <li>You couldn’t support Green as the answer</li> <li>You couldn’t model the case where you run out of a particular color and need to use a different one. This fact cannot be adequately captured without separating the shipped and user specified packaging colors</li> </ul> </li> </ul> <p>In practice, such conflation occurs often and is subtle. It pays off to be vigilant and invest in tooling to mitigate it.</p> <h1 id="some-themes">Some themes</h1> <p>Some themes can be extracted from the patterns above.</p> <ul> <li>Implicit assumptions that are present only in human brains <ul> <li>For example, cardinality assumptions underlying the architecture</li> </ul> </li> <li>Lack of tooling for common changes for which hacky solutions don’t age well <ul> <li>For example, moving from Product type to a Sum type across the stack should be zero-effort</li> </ul> </li> </ul> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/testing-calculator-homomorphism/">Can software testing be objective? Hello from Homomorphisms.</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/abiyz-intro/">How to think about programs &amp; programming? ABIYZ: inspired by age old tools like arithmetic.</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/money-from-symmetry/">What is Money and where does it come from? An answer from symmetry.</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/math-fxy-imo2022/">Solving a Functional Equation using Verbal reasoning. International Math Olympiad 2022, Problem 2.</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/math-putnam21.a3/">An interesting series convergence using geometry. Putnam 2021 A3.</a> </li> </div> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 Subrahmanyam . </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script src="https://unpkg.com/mermaid@10.6.1/dist/mermaid.min.js" integrity="sha256-mm3Re3y7xlvh+yCD+l/Zs1d+PU0AEad93MkWvljfm/s=" crossorigin="anonymous"></script> <script>$(document).ready(function(){mermaid.initialize({startOnLoad:!0,theme:"default"}),window.mermaid.init(undefined,document.querySelectorAll(".language-mermaid"))});</script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>