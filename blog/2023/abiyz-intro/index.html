<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>How to think about programs &amp; programming? Inspiration from age old tools like arithmetic. | Vemana's Space.</title> <meta name="author" content="Subrahmanyam "> <meta name="description" content="This is Vemana's space. I write about Topics include Software Engineering, Math, Life and anything that catches my fancy! "> <meta name="keywords" content="software-engineering, math"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://vemana.github.io/blog/2023/abiyz-intro/"> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">Vemana's Space.</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">How to think about programs &amp; programming? Inspiration from age old tools like arithmetic.</h1> <p class="post-meta">November 19, 2023</p> <p class="post-tags"> <a href="/blog/2023"> <i class="fas fa-calendar fa-sm"></i> 2023 </a>   ·   <a href="/blog/tag/software-abiyz"> <i class="fas fa-hashtag fa-sm"></i> software-abiyz</a>     ·   <a href="/blog/category/software-engineering"> <i class="fas fa-tag fa-sm"></i> software-engineering</a>   </p> </header> <article class="post-content"> <div id="table-of-contents"> <ul id="toc" class="section-nav"> <li class="toc-entry toc-h1"> <a href="#problem-statement">Problem Statement</a> <ul> <li class="toc-entry toc-h2"><a href="#a-thought-experiment-example">A thought experiment example</a></li> </ul> </li> </ul> </div> <hr> <div id="markdown-content"> <h1 id="problem-statement">Problem Statement</h1> <p>A compiler catches errors and more importantly guides us towards syntactically valid programs. Is there a similar guide for thinking about programs &amp; programming? Some thing/process that can help us design systems &amp; program them better ?</p> <h2 id="a-thought-experiment-example">A thought experiment example</h2> <p>Ultimately, programs transform inputs to outputs. Those inputs and outputs have some meaning to humans. Such transforms are common even outside programming; that is, in the real world. We don’t think twice when performing such transforms, but we can learn something by examining one such example in depth.</p> <blockquote class="block-warning"> <p>Problem <code class="language-plaintext highlighter-rouge">Work Desk Area in English</code>: Calculate the surface area of your work desk and express it in words, like <code class="language-plaintext highlighter-rouge">Forty Two</code> or <code class="language-plaintext highlighter-rouge">Sixteen</code>.</p> </blockquote> <p>Your solution likely goes like this:</p> <ol> <li>Model the work desk as a rectangle.</li> <li>Measure the lengths of sides of the desk and consider them to be the rectangle’s dimensions <ul> <li>Capture the dimensions in <code class="language-plaintext highlighter-rouge">PVDS</code> (Place Value Decimal System). Other systems would be possible, for example, binary.</li> </ul> </li> <li>Compute the area using Rectangle’s area formula. <ul> <li>Perform a multiplication of the dimensions in PVDS using some multiplication algorithm</li> <li>The area is now available in PVDS</li> </ul> </li> <li>Take the area in PVDS and announce it in words</li> </ol> <p>We can even <strong>generalize</strong> the solution approach.</p> <div class="jekyll-diagrams diagrams mermaid"> Rendering Failed: mmdc --puppeteerConfigFile /home/runner/work/vemana.github.io/vemana.github.io/vendor/bundle/ruby/3.2.0/gems/jekyll-diagrams-0.10.0/vendor/mermaid_puppeteer_config.json --input /tmp/input20231120-1984-691v8r --output /tmp/output20231120-1984-p2einb.svg: node:internal/process/promises:288 triggerUncaughtException(err, true /* fromPromise */); ^ Error: Evaluation failed: Error: Parse error on line 1: flowchart TBA[Input ^ Expecting 'NEWLINE', 'SPACE', 'GRAPH', got 'ALPHA' at Yt.parseError (file:///usr/local/lib/node_modules/mermaid.cli/mermaid.min.js:1:486512) at Yt.parse (file:///usr/local/lib/node_modules/mermaid.cli/mermaid.min.js:1:487678) at Object.e.getClasses (file:///usr/local/lib/node_modules/mermaid.cli/mermaid.min.js:1:749437) at Object.render (file:///usr/local/lib/node_modules/mermaid.cli/mermaid.min.js:1:759998) at s (file:///usr/local/lib/node_modules/mermaid.cli/mermaid.min.js:8:233) at Object.init (file:///usr/local/lib/node_modules/mermaid.cli/mermaid.min.js:8:318) at __puppeteer_evaluation_script__:17:20 at ExecutionContext._evaluateInternal (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/ExecutionContext.js:122:13) at process.processTicksAndRejections (node:internal/process/task_queues:95:5) at async ExecutionContext.evaluate (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/ExecutionContext.js:48:12) at async ElementHandle.evaluate (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/JSHandle.js:55:12) at async ElementHandle.$eval (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/JSHandle.js:478:20) -- ASYNC -- at ExecutionContext.<anonymous> (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/helper.js:111:15) at ElementHandle.evaluate (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/JSHandle.js:55:42) at ElementHandle.<anonymous> (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/helper.js:112:23) at ElementHandle.$eval (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/JSHandle.js:478:40) at process.processTicksAndRejections (node:internal/process/task_queues:95:5) -- ASYNC -- at ElementHandle.<anonymous> (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/helper.js:111:15) at DOMWorld.$eval (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/DOMWorld.js:156:21) at process.processTicksAndRejections (node:internal/process/task_queues:95:5) -- ASYNC -- at Frame.<anonymous> (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/helper.js:111:15) at Page.$eval (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/Page.js:347:29) at Page.<anonymous> (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/helper.js:112:23) at /usr/local/lib/node_modules/mermaid.cli/index.bundle.js:83:14 at Generator.next (<anonymous>) at step (/usr/local/lib/node_modules/mermaid.cli/index.bundle.js:4:191) at /usr/local/lib/node_modules/mermaid.cli/index.bundle.js:4:361 at process.processTicksAndRejections (node:internal/process/task_queues:95:5) Node.js v18.18.2 &lt;/div&gt; In the `Work Desk area in English`, the Problem Solving Domain (i.e. the abstract world) is Geometry &amp; Arithmetic. <div class="jekyll-diagrams diagrams mermaid"> Rendering Failed: mmdc --puppeteerConfigFile /home/runner/work/vemana.github.io/vemana.github.io/vendor/bundle/ruby/3.2.0/gems/jekyll-diagrams-0.10.0/vendor/mermaid_puppeteer_config.json --input /tmp/input20231120-1984-5z4x13 --output /tmp/output20231120-1984-u342ku.svg: node:internal/process/promises:288 triggerUncaughtException(err, true /* fromPromise */); ^ Error: Evaluation failed: Error: Parse error on line 1: flowchart TBA[Work ^ Expecting 'NEWLINE', 'SPACE', 'GRAPH', got 'ALPHA' at Yt.parseError (file:///usr/local/lib/node_modules/mermaid.cli/mermaid.min.js:1:486512) at Yt.parse (file:///usr/local/lib/node_modules/mermaid.cli/mermaid.min.js:1:487678) at Object.e.getClasses (file:///usr/local/lib/node_modules/mermaid.cli/mermaid.min.js:1:749437) at Object.render (file:///usr/local/lib/node_modules/mermaid.cli/mermaid.min.js:1:759998) at s (file:///usr/local/lib/node_modules/mermaid.cli/mermaid.min.js:8:233) at Object.init (file:///usr/local/lib/node_modules/mermaid.cli/mermaid.min.js:8:318) at __puppeteer_evaluation_script__:17:20 at ExecutionContext._evaluateInternal (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/ExecutionContext.js:122:13) at process.processTicksAndRejections (node:internal/process/task_queues:95:5) at async ExecutionContext.evaluate (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/ExecutionContext.js:48:12) at async ElementHandle.evaluate (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/JSHandle.js:55:12) at async ElementHandle.$eval (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/JSHandle.js:478:20) -- ASYNC -- at ExecutionContext.<anonymous> (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/helper.js:111:15) at ElementHandle.evaluate (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/JSHandle.js:55:42) at ElementHandle.<anonymous> (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/helper.js:112:23) at ElementHandle.$eval (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/JSHandle.js:478:40) at process.processTicksAndRejections (node:internal/process/task_queues:95:5) -- ASYNC -- at ElementHandle.<anonymous> (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/helper.js:111:15) at DOMWorld.$eval (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/DOMWorld.js:156:21) at process.processTicksAndRejections (node:internal/process/task_queues:95:5) -- ASYNC -- at Frame.<anonymous> (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/helper.js:111:15) at Page.$eval (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/Page.js:347:29) at Page.<anonymous> (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/helper.js:112:23) at /usr/local/lib/node_modules/mermaid.cli/index.bundle.js:83:14 at Generator.next (<anonymous>) at step (/usr/local/lib/node_modules/mermaid.cli/index.bundle.js:4:191) at /usr/local/lib/node_modules/mermaid.cli/index.bundle.js:4:361 at process.processTicksAndRejections (node:internal/process/task_queues:95:5) Node.js v18.18.2 &lt;/div&gt; &gt; We can **generalize a pattern of problem solving** from the thought experiment: &gt; * To solve a problem, we need to utilize general tools (like geometry, arithmetic) &gt; * **The tools are abstract, human-invented things and only work with human-invented concepts** &gt; * For example, numbers, place value decimal systems, rectangles, multiplication are all abstract concepts/tools &gt; * There's an abstraction corresponding to Input &amp; Output within each of the two domains, Problem domain &amp; Problem solving domain &gt; * In the Problem domain, the Input is the Work Desk and the output is English words &gt; * In the Problem Solving domain, Input is length &amp; breadth of a rectangle (in PVDS) and the output is an Area (in PVDS) &gt; * To solve the problem, the following steps are followed &gt; * Input from Problem Domain is converted to Input in Problem Solving Domain &gt; * The problem is solved in the Problem solving domain &gt; * The Work Desk Area problem is solved by taking the inputs (i.e. length &amp; breadth) and converting it into the output (i.e. the rectangle's area) &gt; * Output from Problem Solving Domain is converted to Output in Problem Domain {:.block-tip} ## ABIYZ pattern Let's name this pattern of problem solving since we'll refer to it later. Let's call it ABIYZ (for reasons not explained here). &gt; Good scientific laws lead to inferring other scientific laws. For example, Ole Roemer inferred that light had finite speed. He deduced this from the observations that eclipses occur at different times than predicted based on Earth's distance to Jupiter. He held that planetary laws were immutable and looked for a different explanation of the observations. Similar to Roemer's method, we too would like to hold some tenets of software engineering as immutable so that we can discover others when something doesn't quite make sense. What are those tenets? Just like the compiler only allows syntactically valid programs, these tenets should lead to clean, explainable programs. I've been using ABIYZ as one of those immutable tenets and my experience has been very pleasant. It has helped me in designing clearly and avoiding sphagetti mess in code. I have also found it helpful to understand large frameworks. # Relevance for Software Engineering &gt; The purpose of abstraction is not to be vague, but to create a new semantic level in which one can be absolutely precise. - Dijkstra Perhaps the spirit of our learnings from the Work Desk example is succinctly captured by the Dijkstra quote. It applies directly to programming. In the Work Desk example, we used a Problem Solving Domain already available for us (arithmetic, geometry) where as **in programming, we need to invent the Domain and the tools ourself**. &gt; Good software engineering requires inventing the concept of Place Value Decimal System and the Multiplication algorithm to solve the Work Desk Area problem. Numbers and arithmetic is a good problem solving domain for the area problem. {:.block-tip} Different problems will require different domains. Let's see some examples. <hr> ## Example 1 Let's consider implementing the `eval` function. Type | Description ---| --- Input| An expression String, like `(42 * 5) + 3` Output| The evaluation result, in words Function signature| `String eval(String expression)` Example | `eval("(42 * 5) + 3")` returns `"Two Hundred And Thirteen"` <br> To use the ABIYZ pattern,we need to answer a few questions: Question | Answer --- | --- How's the input modeled in the PSD (Problem Solving Domain) ? | Expression Tree How's the output modeled in the PSD? | `long` How is "Solve" modeled in PSD? | `evaluateTree` function What transforms the Input to PSD from PD? | `parse` function What transforms the Output to PD from PSD? | `toWords` function <br> <div class="jekyll-diagrams diagrams mermaid"> Rendering Failed: mmdc --puppeteerConfigFile /home/runner/work/vemana.github.io/vemana.github.io/vendor/bundle/ruby/3.2.0/gems/jekyll-diagrams-0.10.0/vendor/mermaid_puppeteer_config.json --input /tmp/input20231120-1984-wimnax --output /tmp/output20231120-1984-su84ts.svg: node:internal/process/promises:288 triggerUncaughtException(err, true /* fromPromise */); ^ Error: Evaluation failed: Error: Parse error on line 1: flowchart TBA["`Exp ^ Expecting 'NEWLINE', 'SPACE', 'GRAPH', got 'ALPHA' at Yt.parseError (file:///usr/local/lib/node_modules/mermaid.cli/mermaid.min.js:1:486512) at Yt.parse (file:///usr/local/lib/node_modules/mermaid.cli/mermaid.min.js:1:487678) at Object.e.getClasses (file:///usr/local/lib/node_modules/mermaid.cli/mermaid.min.js:1:749437) at Object.render (file:///usr/local/lib/node_modules/mermaid.cli/mermaid.min.js:1:759998) at s (file:///usr/local/lib/node_modules/mermaid.cli/mermaid.min.js:8:233) at Object.init (file:///usr/local/lib/node_modules/mermaid.cli/mermaid.min.js:8:318) at __puppeteer_evaluation_script__:17:20 at ExecutionContext._evaluateInternal (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/ExecutionContext.js:122:13) at process.processTicksAndRejections (node:internal/process/task_queues:95:5) at async ExecutionContext.evaluate (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/ExecutionContext.js:48:12) at async ElementHandle.evaluate (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/JSHandle.js:55:12) at async ElementHandle.$eval (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/JSHandle.js:478:20) -- ASYNC -- at ExecutionContext.<anonymous> (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/helper.js:111:15) at ElementHandle.evaluate (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/JSHandle.js:55:42) at ElementHandle.<anonymous> (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/helper.js:112:23) at ElementHandle.$eval (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/JSHandle.js:478:40) at process.processTicksAndRejections (node:internal/process/task_queues:95:5) -- ASYNC -- at ElementHandle.<anonymous> (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/helper.js:111:15) at DOMWorld.$eval (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/DOMWorld.js:156:21) at process.processTicksAndRejections (node:internal/process/task_queues:95:5) -- ASYNC -- at Frame.<anonymous> (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/helper.js:111:15) at Page.$eval (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/Page.js:347:29) at Page.<anonymous> (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/helper.js:112:23) at /usr/local/lib/node_modules/mermaid.cli/index.bundle.js:83:14 at Generator.next (<anonymous>) at step (/usr/local/lib/node_modules/mermaid.cli/index.bundle.js:4:191) at /usr/local/lib/node_modules/mermaid.cli/index.bundle.js:4:361 at process.processTicksAndRejections (node:internal/process/task_queues:95:5) Node.js v18.18.2 &lt;/div&gt; <hr> Once the ABIYZ questions are answered, we can model the classes &amp; implement the functions: * Classes * `ExpressionTree` * Functions * `ExpressionTree parse(String input)` * `long evaluateTree(ExpressionTree exprTree)` * `String toWords(long value)` The `ExpressionTree` class is straightforward ``` // An ExpressionTree is either of // Addition, Multiplication or just a Number. sealed interface ExpressionTree { record Addition(Expression left, Expression right) implements Expression {} record Multiplication(Expression left, Expression right) implements Expression {} record Number(long value) implements Expression {} } ``` The overall `eval` function is trivial: ```java String eval(String expression) { return toWords(evaluateTree(parse(expression)); } ``` The other functions are straightforward too (use any parser combinator or grammar tools for `parse` function) and we won't implement them here. **KEY IDEAS** * Asking the ABIYZ pattern questions can shed insights on how we think about the problem * We invented new concepts (`ExpressionTree`) to simplify solving the problem * As a bonus, the solution is clean and can be reused effectively. For example, many pieces can be reused for variations of the original problem: * Instead of outputting English Words, output Spanish words * Change the `toWords` function to `toSpanishWords`, `toEnglishWords` etc. Other functions don't need to change * Instead of accepting a String expression, accept a visual input (i.e. need OCR) * Change the `parse` function to `parseOCR`. Other functions don't need to change <hr> ## Example 2 For this example, we'll diff two json documents, the `jsonDiff` function. Type | Description ---| --- Input| Two Json Strings Output| A String capturing the diff result (see below) Function signature| `String jsonDiff(String leftJson, String rightJson)` ``` // Diff output format leftJson = { equal: 42 unequal: 1 leftOnly: "abc" child: { equal: 42 leftOnly: "abc" } equalChild: { a: 1 b: "bcd" } longString: "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa" } rightJson = { equal: 42 unequal: 2 rightOnly: "xyz" child: { equal: 42 rightOnly: "xyz" } equalChild: { a: 1 b: "bcd" } } jsonDiff(leftJson, rightJson) returns the following diff output: != ROOT | == equal 42 | != unequal 1 | 2 | != leftOnly "abc" | <null> | != rightOnly <null> | "xyz" | != longString "aaaaaaaaaaaaaaaaaaaaaaaaaaa | <null> | aaaaaaaaaaaaaaaaaaaaaaaaaaa" | | == equalChild { | a: 1 | b: "bcd" | } | != child | == equal 42 | | != leftOnly "abc" | <null> | != rightOnly <null> | "xyz" | ``` For simplicity of exposition, let's ignore List typed members of the Json (they don't change the story). The rules of the diff strings are: * There are 4 columns of the output, each of a fixed width. * Indicator, like `==` or `!=` * Property name, indented, like `ROOT.child.leftOnly` * Property value on the left side; displayed when there's a diff * Property value on the right side; displayed when there's a diff * Special case: When property values on both sides are equal, display it after merging the columns of the left &amp; right sides * Special note: There's a separator `|` between left and right side columns unless they are merged. * Each property will have one horizontal entry (it could span multiple lines like `equalChild`) * Equal properties have their values displayed. E.g. `equalChild` and `equal` properties * Inequal properties have both sided values displayed. E.g. `unequal` * Properties that occur on only one side should have their values displayed. E.g. `leftOnly` &amp; `rightOnly`. The special `<null>` indicates lack of value for the property. For example, there's no property named `leftOnly` on the right side <br> To use the ABIYZ pattern,we need to answer a few questions: Question | Answer --- | --- How's input json modeled in the PSD (Problem Solving Domain) ? | Using `JsonObject` How's the output modeled in the PSD? | `TextBlock` How is "solve" modeled in PSD? | `diffJsonObjects` function What transforms the Input to PSD from PD? | `jsonParse` function What transforms the Output to PD from PSD? | `TextBlock.toString()` method <div class="jekyll-diagrams diagrams mermaid"> Rendering Failed: mmdc --puppeteerConfigFile /home/runner/work/vemana.github.io/vemana.github.io/vendor/bundle/ruby/3.2.0/gems/jekyll-diagrams-0.10.0/vendor/mermaid_puppeteer_config.json --input /tmp/input20231120-1984-1ik0wo --output /tmp/output20231120-1984-52i07j.svg: node:internal/process/promises:288 triggerUncaughtException(err, true /* fromPromise */); ^ Error: Evaluation failed: Error: Parse error on line 1: flowchart TBA["`(Js ^ Expecting 'NEWLINE', 'SPACE', 'GRAPH', got 'ALPHA' at Yt.parseError (file:///usr/local/lib/node_modules/mermaid.cli/mermaid.min.js:1:486512) at Yt.parse (file:///usr/local/lib/node_modules/mermaid.cli/mermaid.min.js:1:487678) at Object.e.getClasses (file:///usr/local/lib/node_modules/mermaid.cli/mermaid.min.js:1:749437) at Object.render (file:///usr/local/lib/node_modules/mermaid.cli/mermaid.min.js:1:759998) at s (file:///usr/local/lib/node_modules/mermaid.cli/mermaid.min.js:8:233) at Object.init (file:///usr/local/lib/node_modules/mermaid.cli/mermaid.min.js:8:318) at __puppeteer_evaluation_script__:17:20 at ExecutionContext._evaluateInternal (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/ExecutionContext.js:122:13) at process.processTicksAndRejections (node:internal/process/task_queues:95:5) at async ExecutionContext.evaluate (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/ExecutionContext.js:48:12) at async ElementHandle.evaluate (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/JSHandle.js:55:12) at async ElementHandle.$eval (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/JSHandle.js:478:20) -- ASYNC -- at ExecutionContext.<anonymous> (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/helper.js:111:15) at ElementHandle.evaluate (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/JSHandle.js:55:42) at ElementHandle.<anonymous> (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/helper.js:112:23) at ElementHandle.$eval (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/JSHandle.js:478:40) at process.processTicksAndRejections (node:internal/process/task_queues:95:5) -- ASYNC -- at ElementHandle.<anonymous> (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/helper.js:111:15) at DOMWorld.$eval (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/DOMWorld.js:156:21) at process.processTicksAndRejections (node:internal/process/task_queues:95:5) -- ASYNC -- at Frame.<anonymous> (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/helper.js:111:15) at Page.$eval (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/Page.js:347:29) at Page.<anonymous> (/usr/local/lib/node_modules/mermaid.cli/node_modules/puppeteer/lib/helper.js:112:23) at /usr/local/lib/node_modules/mermaid.cli/index.bundle.js:83:14 at Generator.next (<anonymous>) at step (/usr/local/lib/node_modules/mermaid.cli/index.bundle.js:4:191) at /usr/local/lib/node_modules/mermaid.cli/index.bundle.js:4:361 at process.processTicksAndRejections (node:internal/process/task_queues:95:5) Node.js v18.18.2 &lt;/div&gt; We've just invented two concepts that we expect will make it easier to solve the problem: `JsonObject` &amp; `TextBlock`. How do we go about defining them more clearly? We make a few observations: * `JsonObject` should have at least as much information as the input json strings * `TextBlock` should have at least as much information as the final diff string What about the operations on these concepts? We make a few more clarifications: * We create a different class for each of these concepts. Lets call them by the same name; so, we have two classes `JsonObject` and `TextBlock` * The Operations on our Concepts translate to methods on our Classes. * The operations are guided by how `diffJsonObjects` will utilize these concepts. * In other words, we are designing the tools (the methods) so that we can utilize them to help solve the problem easier. This gives us an outline already. ```java sealed interface JsonObject { // A Json value which happens to be another json record JsonStruct(Map&lt;String, JsonObject&gt; children) implements JsonObject { // Obtain the value of a given property, if it exists Optional<jsonobject> getValue(String propertyName) {...} // When we compute the diff, we need to inspect every property Iterable&lt;Map.Entry&lt;String, JsonObject&gt;&gt; allChildren() {...} } // A Json value which happens to be just an integer record JsonInteger(long value) implements JsonObject {} // A Json value which happens to be just a string record JsonString(String value) implements JsonObject {} } ``` Note how JsonStruct has methods that are used by `diffJsonObjects`. <br> Now, let's turn to `TextBlock`, which models the output diff string. Since it should capture the diff string, its structure should perhaps reflect the composition of the diff string. In other words, if we can express the diff string as being composed out of smaller individual units, we will have modeled `TextBlock`. In this image, we can see that the overall diff is composed out of a stack of vertical blocks <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/abiyz-intro-diff-multi-row-composition-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/abiyz-intro-diff-multi-row-composition-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/abiyz-intro-diff-multi-row-composition-1400.webp"></source> <img src="/assets/img/abiyz-intro-diff-multi-row-composition.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> Each of those vertical blocks is composed out of horizontal blocks <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/abiyz-intro-diff-one-row-composition-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/abiyz-intro-diff-one-row-composition-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/abiyz-intro-diff-one-row-composition-1400.webp"></source> <img src="/assets/img/abiyz-intro-diff-one-row-composition.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> There's recursive structure here &amp; we won't go into full details but we are now ready to model the `TextBlock`. * A `TextBlock` is a rectangular block of text * Two `TextBlock`s can be combined either horizontally or vertically. That's all we need to produce the diff string. So, we can now convert it into a simple class definition &amp; operations ```java interface TextBlock { int height(); int width(); // Returns the list of lines that this TextBlock consists of // There will be #height() such returned lines // The size of each line will be #width() characters long List<string> content(); } final class TextBlockOperations { // Appends two TextBlocks side by side and returns this newly appended one. // Their top edges will be aligned. // If their bottom edges don't align, the shorter one will grow downwards to align TextBlock appendHorizontal(TextBlock left, TextBlock right); // Appends two TextBlocks top to bottom and returns this newly appended one. // Their left edges will be aligned. // If their right edges don't align, the shorter one will grown to the right to align TextBlock appendVertical(TextBlock top, TextBlock bottom); // Returns a TextBlock with the specified width and the specified content. // If the content is shorter than width, spaces are used to pad it to 'width'. // If content is larger than width, the TextBlock will keep gaining new height // to accommodate all of the content while never exceeding the width. // So, for width = 3, content = abcdefg, the returned TextBlock will look like // abc // def // g TextBlock create(String content, int width); } ``` It is straightforward to implement all the relevant functions. In particular, `diffJsonObjects` can construct the finall diff `TextBlock` by composing it step by step using the composition operations from `TextBlockOperations`. This example demonstrates how asking simple questions in the ABIYZ pattern enables us to write clean, modular, functional code. The fact that each of these concepts has its own classes means we can test them independently. For example, whether a TextBlock is implemented correctly has nothing to do with what it is used for (like the diffing here). In other words, the ABIYZ pattern encourages defining independent concepts which can then be tested separately. # Summary ABIYZ pattern of problem solving is a useful thought tool that can simplify designing clean, well-factored, well-tested programs for certain classes of programs. It is likely that software engineers are doing this very particular thing, but in an intuitive way when designing programs/systems. ABIYZ formalizes it so that we can approach even difficult problems logically. </string></jsonobject></anonymous></anonymous></anonymous></anonymous></anonymous></anonymous> </div></null></null></null></null></null></null></anonymous></anonymous></anonymous></anonymous></anonymous></anonymous> </div></anonymous></anonymous></anonymous></anonymous></anonymous></anonymous> </div></anonymous></anonymous></anonymous></anonymous></anonymous></anonymous> </div> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/software-changes-and-aging/">Are there changes that accelerate software aging? Yes, here's a small list.</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/testing-calculator-homomorphism/">Can software testing be objective? Hello from Homomorphisms.</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/money-from-symmetry/">What is Money and where does it come from? An answer from symmetry.</a> </li> </div> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2023 Subrahmanyam . </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>